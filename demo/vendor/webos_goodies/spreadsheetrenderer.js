(function(){var e=this;
function i(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array||!(a instanceof Object)&&Object.prototype.toString.call(a)=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(!(a instanceof Object)&&(Object.prototype.toString.call(a)=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call")))return"function"}else return"null";else if(b==
"function"&&typeof a.call=="undefined")return"object";return b}function j(a){a=i(a);return a=="object"||a=="array"||a=="function"}function m(a,b){var c=b||e;if(arguments.length>2){var g=Array.prototype.slice.call(arguments,2);return function(){var f=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(f,g);return a.apply(c,f)}}else return function(){return a.apply(c,arguments)}};var o=/^[a-zA-Z0-9\-_.!~*'()]*$/;function p(a){a=String(a);if(!o.test(a))return encodeURIComponent(a);return a}var q=/&/g,s=/</g,t=/>/g,u=/\"/g,v=/[&<>\"]/;function x(){return Array.prototype.join.call(arguments,"")}(Date.now||function(){return+new Date})();var y,z,A,B;function C(){return e.navigator?e.navigator.userAgent:null}B=A=z=y=false;var D;if(D=C()){var E=e.navigator;y=D.indexOf("Opera")==0;z=!y&&D.indexOf("MSIE")!=-1;A=!y&&D.indexOf("WebKit")!=-1;B=!y&&!A&&E.product=="Gecko"}var F=z,G=B,H=A,I="",J;if(y&&e.opera){var K=e.opera.version;I=typeof K=="function"?K():K}else{if(G)J=/rv\:([^\);]+)(\)|;)/;else if(F)J=/MSIE\s+([^\);]+)(\)|;)/;else if(H)J=/WebKit\/(\S+)/;if(J){var L=J.exec(C());I=L?L[1]:""}};function M(a,b){var c=a.createElement("div");c.innerHTML=b;if(c.childNodes.length==1)return c.removeChild(c.firstChild);else{for(a=a.createDocumentFragment();c.firstChild;)a.appendChild(c.firstChild);return a}}function N(a,b){a.appendChild(b)};function O(a,b){a=a||{};b=b||{};var c=a;if(typeof c!="string"){var g=a.key,f=a.pub===false?false:true;if(!g)throw P('The "key" parameter is required.');c=[f?"http":"https","://spreadsheets.google.com"];a.domain&&!f&&c.push("/a/",p(a.domain));c.push("/tq?key=",p(g));a.sheet?c.push("&sheet=",p(a.sheet)):c.push("&gid=",p(a.gid||0));typeof a.headers=="number"&&c.push("&headers=",a.headers);f&&c.push("&pub=1");c=x.apply(null,c);g={};a=a;for(var n in a)g[n]=a[n];b=b;for(var h in b)g[h]=b[h];b=g}this.b=
new google.visualization.Query(c);this.c=b.template||"";this.a=b.formatter||{}}function Q(a){a=""+a;if(v.test(a)){if(a.indexOf("&")!=-1)a=a.replace(q,"&amp;");if(a.indexOf("<")!=-1)a=a.replace(s,"&lt;");if(a.indexOf(">")!=-1)a=a.replace(t,"&gt;");if(a.indexOf('"')!=-1)a=a.replace(u,"&quot;")}a=a;return a}function P(a){return"SpreadsheetRenderer : "+a}O.prototype.g=function(a){this.c=a};O.prototype.f=function(a){this.a=a};O.prototype.d=function(a,b){this.b.setQuery(a);this.b.send(m(this.e,this,b))};
O.prototype.e=function(a,b){if(!b)throw P("Null response.");if(b.isError())throw P(b.getMessage());b=b.getDataTable();var c=b.getNumberOfColumns(),g=b.getNumberOfRows(),f=[],n=[],h=[],d,k,l,r;for(d=0;d<c;++d){f[d]=b.getColumnLabel(d);n[d]=this.a[f[d]]||this.a[d]||Q}for(k=0;k<g;++k){l={};r={};for(d=0;d<c;++d)l[d]=l[f[d]]={value:b.getFormattedValue(k,d),rawValue:b.getValue(k,d)};for(d=0;d<c;++d)r[d]=r[f[d]]=n[d](l[d].value,l[d].rawValue,l);h[k]=this.c.replace(/%([^%]*)%/g,function(R,w){if(!w||w.length<=
0)return"%";return r[w]})}if(i(a)=="function")a(h,b);else{h=h.join("");j(a)&&a.nodeType>0||(a=typeof a=="string"?document.getElementById(a):a);a&&N(a,M(document,h))}};window.SpreadsheetRenderer=O;O.processResponse=O.h;O.prototype.setTemplate=O.prototype.g;O.prototype.setFormatter=O.prototype.f;O.prototype.render=O.prototype.d;
})();

